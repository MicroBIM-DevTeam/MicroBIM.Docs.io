<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Class MbProjectLocationUtils | MIcroBIM Docs </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Class MbProjectLocationUtils | MIcroBIM Docs ">
      
      <meta name="description" content="Provides utility methods for working with project location transformations in Revit.">
      <link rel="icon" href="../images/logo.ico">
      <link rel="stylesheet" href="../public/docfx.min.css">
      <link rel="stylesheet" href="../public/main.css">
      <meta name="docfx:navrel" content="../toc.html">
      <meta name="docfx:tocrel" content="toc.html">
      
      <meta name="docfx:rel" content="../">
      
      
      
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="ManagedReference">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../index.html">
            <img id="logo" class="svg" src="../images/MicroBimLogo.png" alt="MicroBIM">
            MicroBIM
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="MBF.Revit.Data.Utils.MbProjectLocationUtils">



  <h1 id="MBF_Revit_Data_Utils_MbProjectLocationUtils" data-uid="MBF.Revit.Data.Utils.MbProjectLocationUtils" class="text-break">
Class MbProjectLocationUtils  <a class="header-action link-secondary" title="View source" href="https://github.com/MicroBIM-DevTeam/MBF.Revit.Data/blob/253b5d8129b6e5c10d98b6c3ed591eb52b009297/Utils/MbProjectLocationUtils.cs"><i class="bi bi-code-slash"></i></a>
  </h1>

  <div class="facts text-secondary">
    <dl><dt>Namespace</dt><dd><a class="xref" href="MBF.html">MBF</a>.<a class="xref" href="MBF.Revit.html">Revit</a>.<a class="xref" href="MBF.Revit.Data.html">Data</a>.<a class="xref" href="MBF.Revit.Data.Utils.html">Utils</a></dd></dl>
  <dl><dt>Assembly</dt><dd>MBF.Revit.Data.dll</dd></dl>
  </div>

  <div class="markdown summary">Provides utility methods for working with project location transformations in Revit.</div>
  <div class="markdown conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static class MbProjectLocationUtils</code></pre>
  </div>




  <dl class="typelist inheritance">
    <dt>Inheritance</dt>
    <dd>
      <div><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object">object</a></div>
      <div><span class="xref">MbProjectLocationUtils</span></div>
    </dd>
  </dl>



  <dl class="typelist inheritedMembers">
    <dt>Inherited Members</dt>
    <dd>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.tostring">object.ToString()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object)">object.Equals(object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object-system-object)">object.Equals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.referenceequals">object.ReferenceEquals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gethashcode">object.GetHashCode()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gettype">object.GetType()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.memberwiseclone">object.MemberwiseClone()</a>
    </div>
  </dd></dl>




  <h2 id="MBF_Revit_Data_Utils_MbProjectLocationUtils_remarks">Remarks</h2>
  <div class="markdown level0 remarks">This class includes methods to calculate transformations between the project base point and survey
            point, as well as retrieve project position data. It is intended for use in scenarios where precise location and
            orientation data are required, such as aligning models or extracting geospatial information.</div>


  <h2 class="section" id="methods">Methods
</h2>


  <a id="MBF_Revit_Data_Utils_MbProjectLocationUtils_GetProjectLocationTransform_" data-uid="MBF.Revit.Data.Utils.MbProjectLocationUtils.GetProjectLocationTransform*"></a>

  <h3 id="MBF_Revit_Data_Utils_MbProjectLocationUtils_GetProjectLocationTransform_Autodesk_Revit_DB_Document_" data-uid="MBF.Revit.Data.Utils.MbProjectLocationUtils.GetProjectLocationTransform(Autodesk.Revit.DB.Document)">
  GetProjectLocationTransform(Document)
  <a class="header-action link-secondary" title="View source" href="https://github.com/MicroBIM-DevTeam/MBF.Revit.Data/blob/253b5d8129b6e5c10d98b6c3ed591eb52b009297/Utils/MbProjectLocationUtils.cs"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary">Retrieves the transformation matrix and survey point coordinates that define the relationship between the
project's internal origin and its shared coordinates system.</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static MbResult&lt;(Transform Transform, XYZ SurveyPoint)&gt; GetProjectLocationTransform(Document document)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>document</code> <span class="xref">Document</span></dt>
    <dd>The Revit document from which to retrieve the project location transform. Cannot be <a href="https://learn.microsoft.com/dotnet/csharp/language-reference/keywords/null">null</a>.</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="MB.Common.Utils.Result.MbResult-1.html">MbResult</a>&lt;(<span class="xref">Transform</span> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.valuetuple-autodesk.revit.db.transform,autodesk.revit.db.xyz-.transform">Transform</a>, <span class="xref">XYZ</span> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.valuetuple-autodesk.revit.db.transform,autodesk.revit.db.xyz-.surveypoint">SurveyPoint</a>)&gt;</dt>
    <dd>A result containing a tuple with the transformation matrix and the survey point coordinates. If the operation
fails, the result will contain an error message describing the reason for failure.</dd>
  </dl>







  <h4 class="section" id="MBF_Revit_Data_Utils_MbProjectLocationUtils_GetProjectLocationTransform_Autodesk_Revit_DB_Document__remarks">Remarks</h4>
  <div class="markdown level1 remarks">The transformation matrix combines translation and rotation to align the internal origin with
the shared coordinates system. The survey point coordinates represent the shared survey point in the project's
coordinate system.
<p>
<b>Possible error messages returned to the user:</b>
<ul><li><code>"Document is null."</code> - The provided <code class="paramref">document</code> argument is <a href="https://learn.microsoft.com/dotnet/csharp/language-reference/keywords/null">null</a>.
This indicates that the method was called without a valid Revit document instance.
</li><li><code>"Unable to retrieve project position."</code> - The active project location or its position could not be obtained.
This may occur if the project location is not set or is invalid in the current document.
</li><li>
Any error message returned by <a class="xref" href="MBF.Revit.Data.Utils.MbSurveyPointUtils.html#MBF_Revit_Data_Utils_MbSurveyPointUtils_GetSharedSurveyPointCoordinates_Autodesk_Revit_DB_Document_">GetSharedSurveyPointCoordinates(Document)</a>.
These errors are related to failures in retrieving the shared survey point coordinates, such as missing survey point data
or internal API errors.
</li></ul>
</div>




  <a id="MBF_Revit_Data_Utils_MbProjectLocationUtils_GetProjectPosition_" data-uid="MBF.Revit.Data.Utils.MbProjectLocationUtils.GetProjectPosition*"></a>

  <h3 id="MBF_Revit_Data_Utils_MbProjectLocationUtils_GetProjectPosition_Autodesk_Revit_DB_Document_Autodesk_Revit_DB_XYZ_" data-uid="MBF.Revit.Data.Utils.MbProjectLocationUtils.GetProjectPosition(Autodesk.Revit.DB.Document,Autodesk.Revit.DB.XYZ)">
  GetProjectPosition(Document, XYZ)
  <a class="header-action link-secondary" title="View source" href="https://github.com/MicroBIM-DevTeam/MBF.Revit.Data/blob/253b5d8129b6e5c10d98b6c3ed591eb52b009297/Utils/MbProjectLocationUtils.cs"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary">Retrieves the <span class="xref">ProjectPosition</span> for the specified origin point within the active project location.</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static ProjectPosition GetProjectPosition(Document document, XYZ origin)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>document</code> <span class="xref">Document</span></dt>
    <dd>The <span class="xref">Autodesk.Revit.DB.Document</span> containing the active project location. Must not be <a href="https://learn.microsoft.com/dotnet/csharp/language-reference/keywords/null">null</a>.</dd>
    <dt><code>origin</code> <span class="xref">XYZ</span></dt>
    <dd>The <span class="xref">Autodesk.Revit.DB.XYZ</span> point for which the project position is to be retrieved. Represents the origin in the project
            coordinate system.</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><span class="xref">ProjectPosition</span></dt>
    <dd>The <span class="xref">ProjectPosition</span> corresponding to the specified origin point, or <a href="https://learn.microsoft.com/dotnet/csharp/language-reference/keywords/null">null</a> if the
            active project location is not set.</dd>
  </dl>












</article>



      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          © 2025 MicroBIM. All rights reserved.
        </div>
      </div>
    </footer>
  </body>
</html>
