<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Class MbDimensionUtils | MIcroBIM Docs </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Class MbDimensionUtils | MIcroBIM Docs ">
      
      <meta name="description" content="Provides utility methods for working with special references in Revit family instances.">
      <link rel="icon" href="../images/logo.ico">
      <link rel="stylesheet" href="../public/docfx.min.css">
      <link rel="stylesheet" href="../public/main.css">
      <meta name="docfx:navrel" content="../toc.html">
      <meta name="docfx:tocrel" content="toc.html">
      
      <meta name="docfx:rel" content="../">
      
      
      
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="ManagedReference">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../index.html">
            <img id="logo" class="svg" src="../images/MicroBimLogo.png" alt="MicroBIM">
            MicroBIM
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="MBF.Revit.Creation.Utils.MbDimensionUtils">



  <h1 id="MBF_Revit_Creation_Utils_MbDimensionUtils" data-uid="MBF.Revit.Creation.Utils.MbDimensionUtils" class="text-break">
Class MbDimensionUtils  <a class="header-action link-secondary" title="View source" href="https://github.com/MicroBIM-DevTeam/MBF.Revit.Creation/blob/03cf239ef8c5ac32b66fa3145f672df0f8fe43e2/Utils/MbDimensionUtils.cs"><i class="bi bi-code-slash"></i></a>
  </h1>

  <div class="facts text-secondary">
    <dl><dt>Namespace</dt><dd><a class="xref" href="MBF.html">MBF</a>.<a class="xref" href="MBF.Revit.html">Revit</a>.<a class="xref" href="MBF.Revit.Creation.html">Creation</a>.<a class="xref" href="MBF.Revit.Creation.Utils.html">Utils</a></dd></dl>
  <dl><dt>Assembly</dt><dd>MBF.Revit.Creation.dll</dd></dl>
  </div>

  <div class="markdown summary">Provides utility methods for working with special references in Revit family instances.</div>
  <div class="markdown conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static class MbDimensionUtils</code></pre>
  </div>




  <dl class="typelist inheritance">
    <dt>Inheritance</dt>
    <dd>
      <div><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object">object</a></div>
      <div><span class="xref">MbDimensionUtils</span></div>
    </dd>
  </dl>



  <dl class="typelist inheritedMembers">
    <dt>Inherited Members</dt>
    <dd>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.tostring">object.ToString()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object)">object.Equals(object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object-system-object)">object.Equals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.referenceequals">object.ReferenceEquals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gethashcode">object.GetHashCode()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gettype">object.GetType()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.memberwiseclone">object.MemberwiseClone()</a>
    </div>
  </dd></dl>




  <h2 id="MBF_Revit_Creation_Utils_MbDimensionUtils_remarks">Remarks</h2>
  <div class="markdown level0 remarks">This class includes methods for generating, searching, and categorizing stable references within
            Revit family instances. These utilities are designed to handle complex scenarios such as nested geometry, custom
            reference tokens, and categorized reference collections.</div>


  <h2 class="section" id="methods">Methods
</h2>


  <a id="MBF_Revit_Creation_Utils_MbDimensionUtils_GetAllSpecialFamilyReferences_" data-uid="MBF.Revit.Creation.Utils.MbDimensionUtils.GetAllSpecialFamilyReferences*"></a>

  <h3 id="MBF_Revit_Creation_Utils_MbDimensionUtils_GetAllSpecialFamilyReferences_Autodesk_Revit_DB_FamilyInstance_" data-uid="MBF.Revit.Creation.Utils.MbDimensionUtils.GetAllSpecialFamilyReferences(Autodesk.Revit.DB.FamilyInstance)">
  GetAllSpecialFamilyReferences(FamilyInstance)
  <a class="header-action link-secondary" title="View source" href="https://github.com/MicroBIM-DevTeam/MBF.Revit.Creation/blob/03cf239ef8c5ac32b66fa3145f672df0f8fe43e2/Utils/MbDimensionUtils.cs"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary">Retrieves all special references (plane, line, and point references) from the specified family instance.</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static MbResult&lt;CategorizedReferences&gt; GetAllSpecialFamilyReferences(FamilyInstance familyInstance)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>familyInstance</code> <span class="xref">FamilyInstance</span></dt>
    <dd>The <span class="xref">FamilyInstance</span> from which to extract references. Must not be <a href="https://learn.microsoft.com/dotnet/csharp/language-reference/keywords/null">null</a>.</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="MB.Common.Utils.Result.MbResult-1.html">MbResult</a>&lt;<a class="xref" href="MBF.Revit.Creation.Models.CategorizedReferences.html">CategorizedReferences</a>&gt;</dt>
    <dd>An <a class="xref" href="MB.Common.Utils.Result.MbResult-1.html">MbResult&lt;T&gt;</a> containing a <a class="xref" href="MBF.Revit.Creation.Models.CategorizedReferences.html">CategorizedReferences</a> object with the extracted references
            if successful; otherwise, a failure result with an error message.</dd>
  </dl>







  <h4 class="section" id="MBF_Revit_Creation_Utils_MbDimensionUtils_GetAllSpecialFamilyReferences_Autodesk_Revit_DB_FamilyInstance__remarks">Remarks</h4>
  <div class="markdown level1 remarks">This method categorizes the references into planes, lines, and points by analyzing the geometry of
            the provided family instance. The method will fail if the family instance is <a href="https://learn.microsoft.com/dotnet/csharp/language-reference/keywords/null">null</a>, if its
            associated document is unavailable, or if no geometry or valid references are found.</div>




  <a id="MBF_Revit_Creation_Utils_MbDimensionUtils_GetSpecialFamilyReference_" data-uid="MBF.Revit.Creation.Utils.MbDimensionUtils.GetSpecialFamilyReference*"></a>

  <h3 id="MBF_Revit_Creation_Utils_MbDimensionUtils_GetSpecialFamilyReference_Autodesk_Revit_DB_FamilyInstance_MBF_Revit_Creation_Constants_SpecialReferenceType_" data-uid="MBF.Revit.Creation.Utils.MbDimensionUtils.GetSpecialFamilyReference(Autodesk.Revit.DB.FamilyInstance,MBF.Revit.Creation.Constants.SpecialReferenceType)">
  GetSpecialFamilyReference(FamilyInstance, SpecialReferenceType)
  <a class="header-action link-secondary" title="View source" href="https://github.com/MicroBIM-DevTeam/MBF.Revit.Creation/blob/03cf239ef8c5ac32b66fa3145f672df0f8fe43e2/Utils/MbDimensionUtils.cs"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary">Retrieves a specific reference from a given <span class="xref">FamilyInstance</span> based on the specified <a class="xref" href="MBF.Revit.Creation.Constants.SpecialReferenceType.html">SpecialReferenceType</a>.</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static MbResult&lt;Reference&gt; GetSpecialFamilyReference(FamilyInstance familyInstance, SpecialReferenceType refType)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>familyInstance</code> <span class="xref">FamilyInstance</span></dt>
    <dd>The <span class="xref">FamilyInstance</span> from which to extract the reference. Cannot be <a href="https://learn.microsoft.com/dotnet/csharp/language-reference/keywords/null">null</a>.</dd>
    <dt><code>refType</code> <a class="xref" href="MBF.Revit.Creation.Constants.SpecialReferenceType.html">SpecialReferenceType</a></dt>
    <dd>The type of special reference to retrieve, represented by the <a class="xref" href="MBF.Revit.Creation.Constants.SpecialReferenceType.html">SpecialReferenceType</a> enumeration.</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="MB.Common.Utils.Result.MbResult-1.html">MbResult</a>&lt;<span class="xref">Reference</span>&gt;</dt>
    <dd>An <a class="xref" href="MB.Common.Utils.Result.MbResult-1.html">MbResult&lt;T&gt;</a> containing the resolved <span class="xref">Autodesk.Revit.DB.Reference</span> if successful, or an error message if
            the operation fails.</dd>
  </dl>







  <h4 class="section" id="MBF_Revit_Creation_Utils_MbDimensionUtils_GetSpecialFamilyReference_Autodesk_Revit_DB_FamilyInstance_MBF_Revit_Creation_Constants_SpecialReferenceType__remarks">Remarks</h4>
  <div class="markdown level1 remarks">This method processes the geometry of the provided <span class="xref">FamilyInstance</span> to construct and
            resolve a stable reference based on the specified <code class="paramref">refType</code>. The method ensures that the
            reference is valid and can be used to access the corresponding geometry object. If any step in the process fails,
            an error message is returned in the result.</div>




  <a id="MBF_Revit_Creation_Utils_MbDimensionUtils_GetSpecialFamilyReference_" data-uid="MBF.Revit.Creation.Utils.MbDimensionUtils.GetSpecialFamilyReference*"></a>

  <h3 id="MBF_Revit_Creation_Utils_MbDimensionUtils_GetSpecialFamilyReference_Autodesk_Revit_DB_FamilyInstance_System_String_" data-uid="MBF.Revit.Creation.Utils.MbDimensionUtils.GetSpecialFamilyReference(Autodesk.Revit.DB.FamilyInstance,System.String)">
  GetSpecialFamilyReference(FamilyInstance, string)
  <a class="header-action link-secondary" title="View source" href="https://github.com/MicroBIM-DevTeam/MBF.Revit.Creation/blob/03cf239ef8c5ac32b66fa3145f672df0f8fe43e2/Utils/MbDimensionUtils.cs"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary">Retrieves a reference to a specific family instance in the document, based on a custom identifier.</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static MbResult&lt;Reference&gt; GetSpecialFamilyReference(FamilyInstance familyInstance, string customId)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>familyInstance</code> <span class="xref">FamilyInstance</span></dt>
    <dd>The <span class="xref">FamilyInstance</span> from which the reference is to be retrieved.  This parameter cannot be <a href="https://learn.microsoft.com/dotnet/csharp/language-reference/keywords/null">null</a>.</dd>
    <dt><code>customId</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a></dt>
    <dd>A custom identifier used to build the reference.  This parameter cannot be <a href="https://learn.microsoft.com/dotnet/csharp/language-reference/keywords/null">null</a>, empty, or consist
            only of whitespace.</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="MB.Common.Utils.Result.MbResult-1.html">MbResult</a>&lt;<span class="xref">Reference</span>&gt;</dt>
    <dd>An <a class="xref" href="MB.Common.Utils.Result.MbResult-1.html">MbResult&lt;T&gt;</a> containing the <span class="xref">Autodesk.Revit.DB.Reference</span> if the operation succeeds,  or an error message
            if the operation fails.</dd>
  </dl>







  <h4 class="section" id="MBF_Revit_Creation_Utils_MbDimensionUtils_GetSpecialFamilyReference_Autodesk_Revit_DB_FamilyInstance_System_String__remarks">Remarks</h4>
  <div class="markdown level1 remarks">This method performs a series of validation and processing steps to generate a stable reference  for
            the specified family instance. If any step fails, the method returns a failure result with  an appropriate error
            message.</div>




  <a id="MBF_Revit_Creation_Utils_MbDimensionUtils_GetSpecialFamilyReferenceBySearch_" data-uid="MBF.Revit.Creation.Utils.MbDimensionUtils.GetSpecialFamilyReferenceBySearch*"></a>

  <h3 id="MBF_Revit_Creation_Utils_MbDimensionUtils_GetSpecialFamilyReferenceBySearch_Autodesk_Revit_DB_FamilyInstance_MBF_Revit_Creation_Constants_SpecialReferenceType_System_String_" data-uid="MBF.Revit.Creation.Utils.MbDimensionUtils.GetSpecialFamilyReferenceBySearch(Autodesk.Revit.DB.FamilyInstance,MBF.Revit.Creation.Constants.SpecialReferenceType,System.String)">
  GetSpecialFamilyReferenceBySearch(FamilyInstance, SpecialReferenceType, string)
  <a class="header-action link-secondary" title="View source" href="https://github.com/MicroBIM-DevTeam/MBF.Revit.Creation/blob/03cf239ef8c5ac32b66fa3145f672df0f8fe43e2/Utils/MbDimensionUtils.cs"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary">Searches for a specific geometry reference within a family instance based on the provided search string and
reference type.</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static MbResult&lt;Reference&gt; GetSpecialFamilyReferenceBySearch(FamilyInstance familyInstance, SpecialReferenceType refType, string searchString)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>familyInstance</code> <span class="xref">FamilyInstance</span></dt>
    <dd>The family instance to search within. Must not be <a href="https://learn.microsoft.com/dotnet/csharp/language-reference/keywords/null">null</a>.</dd>
    <dt><code>refType</code> <a class="xref" href="MBF.Revit.Creation.Constants.SpecialReferenceType.html">SpecialReferenceType</a></dt>
    <dd>The type of reference to search for, such as a specific geometry or element type.</dd>
    <dt><code>searchString</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a></dt>
    <dd>The string to match against the geometry or element names. Must not be <a href="https://learn.microsoft.com/dotnet/csharp/language-reference/keywords/null">null</a> or empty.</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="MB.Common.Utils.Result.MbResult-1.html">MbResult</a>&lt;<span class="xref">Reference</span>&gt;</dt>
    <dd>A <a class="xref" href="MB.Common.Utils.Result.MbResult-1.html">MbResult&lt;T&gt;</a> containing the found <span class="xref">Autodesk.Revit.DB.Reference</span> if the search is successful; otherwise, a
            failure result with an appropriate error message.</dd>
  </dl>







  <h4 class="section" id="MBF_Revit_Creation_Utils_MbDimensionUtils_GetSpecialFamilyReferenceBySearch_Autodesk_Revit_DB_FamilyInstance_MBF_Revit_Creation_Constants_SpecialReferenceType_System_String__remarks">Remarks</h4>
  <div class="markdown level1 remarks">This method searches both the symbol and instance geometry of the family instance, including nested
            geometry instances. If no matching reference is found, the method returns a failure result with a descriptive error
            message.</div>





</article>



      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          © 2025 MicroBIM. All rights reserved.
        </div>
      </div>
    </footer>
  </body>
</html>
